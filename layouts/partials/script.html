<!-- font family (loaded via <link> in head for faster FCP — no JS needed) -->
{{$pf:= site.Params.variables.primary_font | default "Poppins:wght@400;500;600;700"}}
{{$sf:= site.Params.variables.secondary_font}}
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family={{$pf}}&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family={{$pf}}&display=swap" media="print" onload="this.media='all'">
{{with $sf}}
<link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family={{.}}&display=swap">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family={{.}}&display=swap" media="print" onload="this.media='all'">
{{end}}
<noscript>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family={{$pf}}&display=swap">
  {{with $sf}}<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family={{.}}&display=swap">{{end}}
</noscript>

<!-- JS Plugins + Main script -->
{{ $scripts := slice }}
{{ range site.Params.plugins.js}}
{{ if findRE "^http" .link }}
<script src="{{ .link | absURL }}" type="application/javascript" {{.attributes | safeHTMLAttr}}></script>
{{ else }}
{{ $scripts = $scripts | append (resources.Get .link) }}
{{ end }}
{{ end }}
{{ $scripts := $scripts | append (resources.Get "js/script.js" | minify) }}
{{ $scripts := $scripts | resources.Concat "/js/script.js" | minify | fingerprint "sha512" }}
<script crossorigin="anonymous" defer="defer" data-turbolinks-suppress-warning integrity="{{ $scripts.Data.Integrity }}" type="application/javascript">{{$scripts.Content | safeJS}}</script>

<!-- mobile burger menu toggle (standalone — does not depend on Bootstrap data-api) -->
<script>
(function(){
  var btn=document.getElementById('navbar-toggler');
  var nav=document.getElementById('navigation');
  if(!btn||!nav)return;
  btn.addEventListener('click',function(){
    var isOpen=nav.classList.contains('show');
    if(isOpen){
      nav.style.height=nav.scrollHeight+'px';
      nav.offsetHeight;/* force reflow */
      nav.classList.add('collapsing');
      nav.classList.remove('collapse','show');
      nav.style.height='';
      btn.classList.add('collapsed');
      btn.setAttribute('aria-expanded','false');
      var onEnd=function(){
        nav.removeEventListener('transitionend',onEnd);
        nav.classList.remove('collapsing');
        nav.classList.add('collapse');
      };
      nav.addEventListener('transitionend',onEnd);
      setTimeout(onEnd,350);/* fallback if transitionend does not fire */
    }else{
      nav.classList.remove('collapse');
      nav.classList.add('collapsing');
      nav.style.height='0';
      nav.offsetHeight;/* force reflow */
      nav.style.height=nav.scrollHeight+'px';
      btn.classList.remove('collapsed');
      btn.setAttribute('aria-expanded','true');
      var onEnd2=function(){
        nav.removeEventListener('transitionend',onEnd2);
        nav.classList.remove('collapsing');
        nav.classList.add('collapse','show');
        nav.style.height='';
      };
      nav.addEventListener('transitionend',onEnd2);
      setTimeout(onEnd2,350);/* fallback */
    }
  });
})();
</script>

<!-- cookie -->
{{ with site.Params.cookies }}
{{ if .enable }}
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-cookie/2.2.1/js.cookie.min.js"></script>
<div id="js-cookie-box" class="cookie-box cookie-box-hide">
	{{.content | markdownify}}<span id="js-cookie-button" class="btn btn-sm btn-outline-primary ml-2">{{.button}}</span>
</div>
<script>
	(function ($) {
		const cookieBox = document.getElementById('js-cookie-box');
		const cookieButton = document.getElementById('js-cookie-button');
		if (!Cookies.get('cookie-box')) {
			cookieBox.classList.remove('cookie-box-hide');
			cookieButton.onclick = function () {
				Cookies.set('cookie-box', true, {
					expires: {{ .expire_days }}
				});
				cookieBox.classList.add('cookie-box-hide');
			};
		}
	})(jQuery);
</script>

<!-- cookie style -->
<style>
.cookie-box {
  position: fixed;
  left: 0;
  right: 0;
  bottom: 0;
  text-align: center;
  z-index: 9999;
  padding: 1rem 2rem;
  background: rgb(71, 71, 71);
  transition: all .75s cubic-bezier(.19, 1, .22, 1);
  color: #fdfdfd;
}

.cookie-box-hide {
  display: none;
}
</style>
{{ end }}
{{ end }}